# レシピ85: 環境変数・機密情報の漏洩を防止する

複数のイベントとマッチャーを組み合わせた多層防御で、APIキーやパスワードのハードコード、機密ファイルへのアクセスを防止します。Write/Editツールでの機密パターン検出、Bashでの機密ファイルアクセスブロック、保護対象ファイルの編集防止の3層で構成されています。

## ファイル一覧

| ファイル | 説明 |
|---------|------|
| `detect-secrets.sh` | ファイル書き込み時に機密情報パターン（AWSキー、APIキー等）を検出するスクリプト |
| `protect-files.sh` | `.env`や`credentials`等の保護対象ファイルへの編集をブロックするスクリプト |
| `hooks-settings.json` | 多層防御のフック登録用`settings.json`設定例（パーミッション設定含む） |