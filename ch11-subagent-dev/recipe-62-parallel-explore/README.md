# レシピ62: 並列実行で大規模コードベースを高速調査する

複数のExploreサブエージェントを並列で起動し、それぞれ異なるモジュールを同時に調査させることで、大規模コードベースの調査を高速化します。

## ファイル一覧

| ファイル | 説明 |
|---------|------|
| `.claude/agents/module-investigator.md` | モジュール構造の調査を行うカスタムサブエージェント定義 |
| `prompts/parallel-investigation.txt` | 3モジュール並列調査のプロンプト例 |
| `prompts/result-integration.txt` | 調査結果を統合・分析するプロンプト例 |

## 使い方

```bash
# カスタムエージェント定義をプロジェクトに配置
cp -r .claude /path/to/your-project/

# Claude Codeで並列調査を依頼
> 以下の3つのモジュールを並列で調査してください:
> 1. src/auth/ - 認証フロー全体のファイル構成とエントリーポイント
> 2. src/database/ - ORMの利用パターンとマイグレーション構成
> 3. src/api/ - ルーティング構成とミドルウェアチェーン
```

## 並列調査の基本パターン

```
メインの会話
  |
  +-- [Explore] 認証モジュールの調査
  +-- [Explore] データベース層の調査
  +-- [Explore] APIルーティングの調査
  |
  +-- 3つの結果を統合して分析
```

Claude Codeに「並列で調査して」と指示するだけで、独立したExploreサブエージェントが同時に起動します。各サブエージェントはHaikuモデルで動作するため、高速かつ低コストです。

## 設計のポイント

- **調査の観点を明確に指定する**: 「src/authを調べて」のような曖昧な指示では、網羅的に探索しようとしてターン数を消費する
- **並列数は3〜5個に抑える**: サブエージェントの結果はメインのコンテキストに返されるため、多すぎるとコンテキストが圧迫される
- **独立性の高いモジュール単位で分割する**: 依存関係のないモジュールを並列調査の対象にする
- **ビルトインExploreよりカスタムエージェントが有効**: プロジェクト固有の調査基準を定義すると一貫した品質の結果が得られる

## 関連レシピ

- レシピ57「Taskツールの仕組みと独立コンテキスト」
- レシピ58「エージェント種別の使い分け」
- レシピ61「永続メモリパターン」
