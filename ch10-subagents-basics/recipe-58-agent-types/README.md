# レシピ58: エージェント種別の使い分け

Claude Codeに組み込まれた4つのエージェント種別の特徴と使い分けを解説します。

## ビルトインエージェント種別の比較

| エージェント種別 | モデル | アクセス権限 | 主な用途 |
|-----------------|--------|-------------|----------|
| **Explore** | Haiku | 読み取り専用 | コードベース調査、ファイル検索、構造把握 |
| **Plan** | 継承（inherit） | 読み取り専用 | 実装計画の策定、設計レビュー、依存関係分析 |
| **general-purpose** | 継承（inherit） | 全ツール | 汎用タスク、ファイル編集、コマンド実行 |
| **Bash** | 継承（inherit） | Bashのみ | シェルコマンド実行、スクリプト処理 |

## 各種別の詳細

### Explore（探索エージェント）

```
Task(agent_type="Explore", prompt="src/ディレクトリの構造を調査して")
```

- **モデル**: Haiku（高速・低コスト）
- **ツール**: `Read`, `Glob`, `Grep` のみ（読み取り専用）
- **特徴**: コードベースの調査に最適化。ファイルの変更はできない
- **コスト**: Opusの約1/53のトークン単価（最も低コスト）

**適した用途**:
- プロジェクト構造の把握
- 特定パターンのコード検索
- 依存関係の調査
- ファイル一覧の取得

### Plan（計画エージェント）

```
Task(agent_type="Plan", prompt="認証機能の実装計画を策定して")
```

- **モデル**: 継承（メインセッションと同じモデル）
- **ツール**: `Read`, `Glob`, `Grep` のみ（読み取り専用）
- **特徴**: 読み取り専用だがメインと同じモデルで高精度な分析が可能

**適した用途**:
- 実装計画の策定
- アーキテクチャ設計レビュー
- リファクタリング方針の検討
- 技術的な意思決定の支援

### general-purpose（汎用エージェント）

```
Task(agent_type="general-purpose", prompt="テストを追加して")
```

- **モデル**: 継承（メインセッションと同じモデル）
- **ツール**: 全ツール（Read, Write, Edit, Bash, Glob, Grep, etc.）
- **特徴**: 制限なしの完全なエージェント。ファイル編集やコマンド実行が可能

**適した用途**:
- コードの実装・修正
- テストの作成と実行
- ファイルの生成・編集
- 複雑なタスクの自動化

### Bash（Bashエージェント）

```
Task(agent_type="Bash", prompt="npm testを実行して結果を報告して")
```

- **モデル**: 継承（メインセッションと同じモデル）
- **ツール**: `Bash` のみ
- **特徴**: シェルコマンドに特化した軽量エージェント

**適した用途**:
- テスト実行
- ビルドプロセスの実行
- システムコマンドの実行
- ログの確認

## 使い分けのフローチャート

```
タスクの種類は？
├── 調査・検索のみ → コストを抑えたい？
│   ├── はい → Explore（Haiku、低コスト）
│   └── いいえ → Plan（高精度な分析）
├── シェルコマンドのみ → Bash
└── ファイル変更が必要 → general-purpose
```

## コスト比較の目安

| エージェント種別 | 相対コスト | 理由 |
|-----------------|-----------|------|
| Explore | 最低 | Haikuモデル + 読み取り専用 |
| Plan | 中 | 継承モデル + 読み取り専用 |
| Bash | 中 | 継承モデル + Bashのみ |
| general-purpose | 最高 | 継承モデル + 全ツール |

## 設計のポイント

- 読み取り専用で済むタスクにgeneral-purposeを使うのはコストの無駄
- Exploreは大量の並列調査に最適（低コストで高速）
- Planはメインと同じモデルで分析するため、複雑な設計判断に向く
- カスタムエージェント（レシピ59）でさらに細かい制御が可能

## 関連レシピ

- レシピ57「Taskツールの仕組みと独立コンテキスト」
- レシピ59「カスタムエージェントの定義」
- レシピ78「コスト最適化パターン」
