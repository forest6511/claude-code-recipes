# レシピ59: カスタムエージェントを定義する

`.claude/agents/`ディレクトリにMarkdownファイルを配置して、専門的な役割を持つカスタムエージェントを作成します。

## ファイル一覧

| ファイル | 説明 |
|---------|------|
| `.claude/agents/code-reviewer.md` | コード品質とセキュリティのレビューを実施する専門エージェント（Sonnetモデル指定） |
| `.claude/agents/debugger.md` | バグの根本原因を調査し、最小限の修正で解決するデバッグエージェント |

## 使い方

```bash
# プロジェクトにエージェント定義を配置
cp -r .claude/agents /path/to/your-project/.claude/agents

# Claude Codeでカスタムエージェントを呼び出し
> @code-reviewer src/ディレクトリのコードをレビューして
> @debugger ログイン時にエラーが出る問題を調査して
```

## エージェント定義の構造

カスタムエージェントは、YAMLフロントマター + Markdown本文で定義します。

```markdown
---
name: agent-name           # エージェントの識別名（必須）
description: 説明文         # エージェントの役割説明（必須）
model: sonnet              # 使用モデル（省略時はメインセッションを継承）
tools:                     # 使用可能なツール一覧
  - Read
  - Grep
  - Glob
---

# Agent Title

エージェントへの指示（システムプロンプトとして機能）
```

## フロントマターの主要フィールド

| フィールド | 必須 | 説明 |
|-----------|------|------|
| `name` | 必須 | エージェントの識別名。`@name`で呼び出し時に使用 |
| `description` | 必須 | エージェントの役割を簡潔に記述 |
| `model` | 任意 | `opus`, `sonnet`, `haiku` から指定。省略時は継承 |
| `tools` | 任意 | 使用許可するツール名のリスト。省略時は全ツール |
| `disallowedTools` | 任意 | 使用禁止するツール名のリスト |
| `memory` | 任意 | メモリスコープ（`user`, `project`, `local`） |

## 設計のポイント

- **単一責任**: 1つのエージェントに1つの専門領域を割り当てる
- **ツール制限**: 必要最小限のツールのみ許可する（安全性の向上）
- **モデル選択**: 読み取り専用タスクにはHaikuやSonnetでコスト削減
- **明確な指示**: Markdown本文に具体的な手順・出力フォーマットを記載する
- **制約の明示**: エージェントがやってはいけないことを明記する

## 関連レシピ

- レシピ57「Taskツールの仕組みと独立コンテキスト」
- レシピ60「tools/disallowedToolsで権限を制御する」
- レシピ61「永続メモリパターン」
